name: Extension CI

on:
  push:
    paths:
      - 'extension/**'
  pull_request:
    paths:
      - 'extension/**'

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Validate manifest.json
        run: node -e "JSON.parse(require('fs').readFileSync('extension/manifest.json','utf8')); console.log('manifest.json is valid JSON')"

      - name: Syntax check JavaScript
        run: |
          node --check extension/background.js
          node --check extension/options.js
          echo "All JS files pass syntax check"

      - name: Verify icons exist
        run: |
          test -f extension/icons/icon-16.png || (echo "Missing icon-16.png" && exit 1)
          test -f extension/icons/icon-48.png || (echo "Missing icon-48.png" && exit 1)
          test -f extension/icons/icon-128.png || (echo "Missing icon-128.png" && exit 1)
          echo "All icons present"
