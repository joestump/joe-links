{{template "base" .}}

{{define "title"}}Keywords — Admin — Joe Links{{end}}

{{define "content"}}
<!-- Governing: SPEC-0008 REQ "Keyword Host Discovery", ADR-0011 -->
<div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold">Keyword Templates</h1>
    <a href="/admin" class="btn btn-ghost btn-sm">&larr; Admin</a>
</div>

<!-- Create form -->
<form hx-post="/admin/keywords" hx-target="#keyword-list" hx-swap="outerHTML" class="card bg-base-200 p-4 mb-6">
    <div class="flex gap-3 flex-wrap">
        <input type="text" name="keyword" placeholder="keyword (e.g. jira)"
               class="input input-bordered w-32 font-mono" required />
        <input type="text" name="url_template" placeholder="https://example.com/search?q={slug}"
               class="input input-bordered flex-1" required />
        <input type="text" name="description" placeholder="Description (optional)"
               class="input input-bordered w-48" />
        <button type="submit" class="btn btn-primary">Add</button>
    </div>
    <p class="text-xs text-base-content/60 mt-1">URL template must contain <code>{slug}</code></p>
</form>

<!-- Keyword list -->
<div id="keyword-list">
    {{template "keyword_list" .}}
</div>
{{end}}

{{define "keyword_list"}}
{{if .Error}}
<div class="alert alert-error mb-4"><span>{{.Error}}</span></div>
{{end}}
<table class="table w-full">
    <thead>
        <tr>
            <th>Keyword</th>
            <th>URL Template</th>
            <th>Description</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
    {{range .Keywords}}
    <tr id="keyword-{{.ID}}">
        <td><code class="font-mono font-semibold">{{.Keyword}}</code></td>
        <td class="text-sm font-mono">{{.URLTemplate}}</td>
        <td class="text-sm text-base-content/70">{{.Description}}</td>
        <td>
            <!-- Governing: SPEC-0013 REQ "DaisyUI Delete Confirmation Modal", SPEC-0014 -->
            <button class="btn btn-xs btn-ghost text-error tooltip tooltip-left"
                    data-tip="Delete"
                    hx-get="/admin/keywords/{{.ID}}/confirm-delete"
                    hx-target="#modal"
                    hx-swap="innerHTML">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
            </button>
        </td>
    </tr>
    {{else}}
    <tr><td colspan="4" class="text-center text-base-content/50">No keywords configured.</td></tr>
    {{end}}
    </tbody>
</table>
{{end}}
