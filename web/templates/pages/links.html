{{template "base" .}}

{{define "title"}}Browse Links — Joe Links{{end}}

{{define "content"}}
<!-- Governing: SPEC-0012 REQ "Public Link Browser (GET /links)" -->
<div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold">Browse Links</h1>
    <span class="text-sm text-base-content/60">{{.Total}} link{{if ne .Total 1}}s{{end}}</span>
</div>

<!-- Governing: SPEC-0012 REQ "Public Link Search" — search input with HTMX debounce -->
<div class="mb-6">
    <input
        type="search"
        name="q"
        class="input input-bordered w-full"
        placeholder="Search by slug, URL, title, or description..."
        value="{{.Query}}"
        hx-get="/links"
        hx-trigger="input changed delay:300ms, search"
        hx-target="#public-link-list"
        hx-select="#public-link-list"
        hx-swap="outerHTML"
        hx-push-url="true"
    >
</div>

<div id="public-link-list">
{{if .Links}}
{{template "link_list" .}}

<!-- Pagination controls -->
{{if or .HasPrev .HasNext}}
<div class="flex justify-center gap-2 mt-8">
    {{if .HasPrev}}
    <a href="/links?page={{.PrevPage}}{{if .Query}}&q={{.Query}}{{end}}"
       class="btn btn-sm btn-outline">Previous</a>
    {{end}}
    <span class="btn btn-sm btn-disabled">Page {{.Page}} of {{.TotalPages}}</span>
    {{if .HasNext}}
    <a href="/links?page={{.NextPage}}{{if .Query}}&q={{.Query}}{{end}}"
       class="btn btn-sm btn-outline">Next</a>
    {{end}}
</div>
{{end}}

{{else}}
<div class="hero py-16">
    <div class="hero-content text-center">
        <div>
            {{if .Query}}
            <h2 class="text-xl font-semibold mb-2">No links found</h2>
            <p class="text-base-content/60">No public links match your search. Try different keywords.</p>
            {{else}}
            <h2 class="text-xl font-semibold mb-2">No public links yet</h2>
            <p class="text-base-content/60">There are no public links to browse.</p>
            {{end}}
        </div>
    </div>
</div>
{{end}}
</div>
{{end}}
